<div id="step1">
  <section class="section-desktop" *ngIf="!(isMobile | async)?.matches">
    <div class="container">
      <div class="row">
        <div class="col-md-12">
          <h3>What would you like to do?</h3>
          <p>Select the type of project you would like to create.</p>
        </div>
      </div>
      <br>
      <div class="row">
        <div class="col-md-12">
          <div class="swiper-container" fxFlex="auto" [swiper]="config" [(index)]="index"
            (indexChange)="onIndexChange($event)" (swiperTransitionStart)="onSwiperEvent('transitionStart')"
            (swiperTransitionEnd)="onSwiperEvent('transitionEnd')" *ngIf="programmingTasks">
            <div class="swiper-wrapper">
              <ng-container *ngFor="let task of programmingTasks; let i = index;">
                <div class="swiper-slide product-box box-{{ i }}" id="box-{{ i }}" (click)="selectProduct(task.id)">
                  <div class="product-icon-box">
                    <img src="assets/img/{{ task.id }}.svg" class="product-icon">
                  </div>
                  <h4>{{ task.name }}</h4>
                  <p>{{ task.description }}</p>
                </div>
              </ng-container>
            </div>
            <div class="swiper-button-prev" [hidden]="index === 0"></div>
            <div class="swiper-button-next" [hidden]="lastIndex"></div>
          </div>
        </div>
      </div>
    </div>
  </section>

  <section class="section-mobile" *ngIf="(isMobile | async)?.matches">
    <p>
      {{ task }}
    </p>
  </section>
</div>

<div id="step2">
  <div *ngIf="!(isMobile | async)?.matches && productSelected && step2Active">
    <!-- Header -->
    <div class="row step-header-row">
      <div class="col-md-6">
        <div class="step-header-box" style="padding-left: 1em">
          <img src="assets/img/logo.svg" style="height: 36px; width: 36px">
        </div>
      </div>
      <div class="col-md-6">
        <div class="pull-right step-header-box">
          <button type="button" class="btn btn-secondary" (click)="showResetModal()">Reset</button>
        </div>
      </div>
    </div>
    <section class="section-desktop-alternate">
      <div class="container">
        <div class="row" [ngStyle]="{ 'height': innerColumnHeight + 'px' }">
          <div class="col-md-12" style="padding-top: 2em">
            <h3>What are you building?</h3>
            <p>Help us understand your project better.</p>
            <div class="col-md-6" style="padding-left: 0">
              <div class="form-group">
                <label>Enter a project name <span class="text-danger">*</span></label>
                <input class="form-control form-control-sm" type="text" [(ngModel)]="taskName"
                  (change)="taskName=taskName.trim();">
              </div>
              <div class="form-group">
                <label>Provide a description <span class="text-danger">*</span></label>
                <textarea class="form-control form-control-sm" [(ngModel)]="taskDescription"
                  (change)="taskDescription=taskDescription.trim();"></textarea>
              </div>
              <div class="form-group">
                <label>Select any similar apps</label>
                <tag-input [onlyFromAutocomplete]="true" [maxItems]="3" placeholder="" [(ngModel)]="taskSimilarApps">
                  <tag-input-dropdown [focusFirstElement]="true" [autocompleteItems]="similarApps"
                    [dynamicUpdate]="false">
                  </tag-input-dropdown>
                </tag-input>
              </div>
              <div class="form-group" style="padding-top: 1em">
                <button type="button" class="btn btn-secondary" (click)="prevStep1()">Previous</button>
                &nbsp;
                <button type="button" (click)="setTaskNameAndDescription()" class="btn btn-primary"
                  [disabled]="!taskName || !taskDescription || taskName.length === 0 || taskDescription.length === 0">Continue</button>
              </div>
            </div>
          </div>
        </div>
      </div>
    </section>
  </div>
</div>

<div id="step3">
  <section class="section-desktop-alternate" *ngIf="!(isMobile | async)?.matches && taskName && taskDescription && step3Active">
    <!-- Header -->
    <div class="row step-header-row">
      <div class="col-md-6">
        <div class="step-header-box" style="padding-left: 1em">
          <img src="assets/img/logo.svg" style="height: 36px; width: 36px">
        </div>
      </div>
      <div class="col-md-6">
        <div class="pull-right step-header-box">
          <button type="button" class="btn btn-secondary cart" (click)="showBasketModal()">
            <span><i class="ti-shopping-cart"></i></span>
            <span *ngIf="basket && basket.length > 0">&nbsp;</span>
            <span class="badge badge-pill badge-danger" *ngIf="basket && basket.length > 0">{{ basket.length }}</span>
          </button>
          &nbsp;
          <button type="button" class="btn btn-secondary" (click)="showResetModal()">Reset</button>
        </div>
      </div>
    </div>
    <!-- Category column -->
    <div class="row" style="margin-right: 0px;" [ngStyle]="{ 'height': innerColumnHeight + 'px' }">
      <div class="col-md-3 categories-column">
        <div class="categories-header">Categories</div>
        <div class="sidebar-scroll" [ngStyle]="{ 'height': innerColumnSidebarHeight + 'px' }">
          <div class="card shadow-4 card-category" *ngFor="let category of webCategories;">
            <div class="card-body" (click)="selectCategory(category.id)">
              <h5 class="card-title">{{ category.name }}</h5>
              <div style="right: 1em; top: 0.75em; position: absolute">
                <img src="assets/img/{{ category.id }}.svg" style="height: 30px; width: 30px">
              </div>
              {{ category.description }}
            </div>
          </div>
        </div>
      </div>
      <!-- Features column -->
      <div class="col-md-3 categories-column" style="padding-left: 0px;">
        <div class="libraries-title" style="border-right: 0">Features</div>
        <div class="sidebar-scroll" [ngStyle]="{ 'height': innerColumnSidebarHeight + 'px' }">
          <!-- If empty -->
          <div *ngIf="!categorySelected" style="height: 100%">
            <div class="container h-100">
              <div class="row h-100 justify-content-center align-items-center">
                <div class="col-md-12 text-center">
                  <span style="text-align: center; font-size: 10px;">
                    There's nothing to see here.
                  </span>
                </div>
              </div>
            </div>
          </div>
          <!-- Custom libraries -->
          <div *ngIf="categorySelected == 'custom'">
            <div style="padding: 1em">
              <button class="btn btn-secondary btn-block" type="button" (click)="showRequestFeatureModal()">Request
                Feature</button>
            </div>
            <div *ngFor="let custom of webCustom">
              <div class="accordion accordion-light accordion-arrow-right" [attr.id]="'accordion-' + custom.id">
                <div class="card">
                  <span class="card-title" style="font-weight: strong">
                    <a class="collapsed" data-toggle="collapse" [href]="'#collapse-' + custom.id">{{ custom.name }}</a>
                  </span>
                  <div [attr.id]="'collapse-' + custom.id" class="collapse"
                    [attr.data-parent]="'#accordion-' + custom.id">
                    <div class="card-body" style="padding: 0" *ngFor="let custom of getFeatures(custom.id)">
                      <div class="col-md-12" style="padding: 0">
                        <div class="card card-body no-border card-highlight" (click)="selectFeature(custom)"
                          style="padding-top: 0.5rem; padding-bottom: 0.5rem" [style.background-color]="setFeatureBgColor(custom)">
                          <div class="row">
                            <div class="col-md-8" style="font-size: 11px; padding-top: 5px">
                              {{ custom.name }}
                            </div>
                            <div class="col-md-4" style="text-align: right;">
                              <button class="btn btn-xs btn-success" (click)="addToBasket(custom)"
                                *ngIf="!custom.in_basket" style="width: 78px">Add</button>
                              <button class="btn btn-xs btn-danger" (click)="removeFromBasket(custom)"
                                *ngIf="custom.in_basket" style="width: 78px">Remove</button>
                            </div>
                          </div>
                        </div>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </div>
          <!-- Chatbot libraries -->
          <div *ngIf="categorySelected == 'chatbot'" style="height: 100%">
            <div class="container h-100">
              <div class="row h-100 justify-content-center align-items-center">
                <div class="col-md-12 text-center">
                  <span style="text-align: center; font-size: 10px;">
                    This feature is currently under construction.
                  </span>
                </div>
              </div>
            </div>
          </div>
          <!-- Shopify libraries -->
          <div *ngIf="categorySelected == 'shopify'" style="height: 100%">
            <div class="container h-100">
              <div class="row h-100 justify-content-center align-items-center">
                <div class="col-md-12 text-center">
                  <span style="text-align: center; font-size: 10px;">
                    This feature is currently under construction.
                  </span>
                </div>
              </div>
            </div>
          </div>
          <!-- Squarespace libraries -->
          <div *ngIf="categorySelected == 'squarespace'" style="height: 100%">
            <div class="container h-100">
              <div class="row h-100 justify-content-center align-items-center">
                <div class="col-md-12 text-center">
                  <span style="text-align: center; font-size: 10px;">
                    This feature is currently under construction.
                  </span>
                </div>
              </div>
            </div>
          </div>
          <!-- Wordpress libraries -->
          <div *ngIf="categorySelected == 'wordpress'" style="height: 100%">
            <div class="container h-100">
              <div class="row h-100 justify-content-center align-items-center">
                <div class="col-md-12 text-center">
                  <span style="text-align: center; font-size: 10px;">
                    This feature is currently under construction.
                  </span>
                </div>
              </div>
            </div>
          </div>
          <!-- Wix libraries -->
          <div *ngIf="categorySelected == 'wix'" style="height: 100%">
            <div class="container h-100">
              <div class="row h-100 justify-content-center align-items-center">
                <div class="col-md-12 text-center">
                  <span style="text-align: center; font-size: 10px;">
                    This feature is currently under construction.
                  </span>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
      <!-- Information column -->
      <div class="col-md-6" style="padding:0px">
        <!-- If empty -->
        <div *ngIf="!featureSelected" style="height: 100%">
          <div class="container h-100">
            <div class="row h-100 justify-content-center align-items-center">
              <div class="col-md-12 text-center">
                <span style="text-align: center; font-size: 10px;">
                  There's nothing to see here.
                </span>
              </div>
            </div>
          </div>
        </div>
        <!-- When a feature is selected -->
        <div *ngIf="featureSelected">
          <div class="details-title" style="border-left: 0">
            <div class="row">
              <div class="col-md-12">
                <div style="font-size: 12px; font-weight: bold">{{ featureSelected.name }} -
                  &pound;{{ featureSelected.price_gbp | number : '1.2-2' }}</div>
                <div style="font-size: 10px">{{ featureSelected.description }}</div>
              </div>
            </div>
          </div>
          <div style="display: flex; align-items: center; justify-content: center;"
            [ngStyle]="{ 'height': innerHeight - 190 + 'px' }">
            <div class="browser-mockup" style="background-color: #fff">
              <img src="assets/img/{{ featureSelected.id }}.png">
            </div>
          </div>
        </div>
        <div class="builder-step-navigator">
          <div style="text-align: right">
            <button type="button" class="btn btn-secondary" (click)="prevStep2()">Previous</button>
            &nbsp;
            <button type="button" class="btn btn-primary" [disabled]="true">Continue</button>
          </div>
        </div>
      </div>
    </div>
  </section>
</div>

<!-- Reset modal -->
<div class="modal fade" #resetModal id="resetModal" tabindex="-1" role="dialog" aria-labelledby="resetModal"
  aria-hidden="!submitted">
  <div class="modal-dialog" role="document">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title" id="resetModal">Reset</h5>
        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body">Are you sure you want to start all over again?</div>
      <div class="modal-footer">
        <button type="button" class="btn btn-secondary" (click)="reset()">Yes</button>
        <button type="button" class="btn btn-secondary" data-dismiss="modal">No</button>
      </div>
    </div>
  </div>
</div>

<!-- Request Feature modal -->
<div class="modal fade" #requestFeatureModal id="requestFeatureModal" tabindex="-1" role="dialog"
  aria-labelledby="requestFeatureModal" aria-hidden="!submitted">
  <div class="modal-dialog" role="document">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title">Request Feature</h5>
        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body">
        <small>Please note that pricing and development time may only be decided once the requirements of the project
          have been fully understood.</small>
        <div class="row" style="padding-top: 2em">
          <div class="col-md-4">
            <strong>Name your feature <span class="text-danger">*</span></strong>
          </div>
          <div class="col-md-8">
            <div class="input-group">
              <input type="text" class="form-control" [(ngModel)]="customFeatureName"
                (change)="customFeatureName=customFeatureName.trim();">
            </div>
          </div>
        </div>
        <br>
        <div class="row">
          <div class="col-md-4">
            <strong>Describe your feature <span class="text-danger">*</span></strong>
          </div>
          <div class="col-md-8">
            <div class="input-group">
              <textarea class="form-control" [(ngModel)]="customFeatureDescription"
                (change)="customFeatureDescription=customFeatureDescription.trim();"></textarea>
            </div>
          </div>
        </div>
        <br>
        <div class="row">
          <div class="col-md-4">
            <strong>Please list any apps with a similar feature</strong>
          </div>
          <div class="col-md-8">
            <tag-input [onlyFromAutocomplete]="false" [maxItems]="3" [(ngModel)]="customFeatureSimilarApps"></tag-input>
          </div>
        </div>
      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-secondary"
          [disabled]="!customFeatureName || !customFeatureDescription || customFeatureName.length === 0 || customFeatureDescription.length === 0">Done</button>
      </div>
    </div>
  </div>
</div>

<!-- Basket modal -->
<div class="modal fade" #basketModal id="basketModal" tabindex="-1" role="dialog" aria-labelledby="basketModal"
  aria-hidden="!submitted">
  <div class="modal-dialog" role="document">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title" id="basketModal">Basket</h5>
        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body" [ngStyle]="{ 'max-height': innerHeight - 190 + 'px' }" *ngIf="basket.length > 0"
        style="padding: 0">
        <div style="overflow-x:hidden; height: 100%;" class="sidebar-scroll">
          <table class="table table-cart" style="margin-bottom: 0">
            <tbody valign="middle">
              <tr *ngFor="let basketItem of basket">
                <td width="65px">
                  <a class="item-remove" href="#"><i class="ti-close"></i></a>
                </td>
                <td>
                  <h5>{{ basketItem.name }}</h5>
                  <small>{{ basketItem.description }}</small>
                </td>
                <td>
                  <h5 class="price">&pound;{{ basketItem.price_gbp | number : '1.2-2' }}</h5>
                </td>
              </tr>
            </tbody>
          </table>
          <div class="cart-price" style="border-radius: 0; border-top: 0; border-bottom: 0; margin-bottom: 0">
            <div class="flexbox">
              <div>
                <p><strong>Total:</strong></p>
              </div>
              <div>
                <h5 class="fw-600">&pound;{{ basketGbpTotal | number : '1.2-2' }}</h5>
              </div>
            </div>
          </div>
        </div>
      </div>
      <div class="modal-body" *ngIf="basket.length == 0">There's nothing to see here.</div>
      <div class="modal-footer">
        <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
      </div>
    </div>
  </div>
</div>